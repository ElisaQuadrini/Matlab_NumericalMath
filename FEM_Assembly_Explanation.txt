FEM Assembly Example (1D Poisson Problem)

----------------------------------------------------
1. What is φ (phi)?
----------------------------------------------------
In the Finite Element Method (FEM), we do not approximate the solution u(x)
everywhere directly. Instead, we use *basis functions* φ_i(x), also called
*shape functions*. Each φ_i(x) is equal to 1 at node i and 0 at all other nodes.
They are "hat functions" (triangular in 1D).

Example with 3 nodes [0, 0.5, 1]:
- φ1(x): 1 at x=0, decreases to 0 at x=0.5, then remains 0 until x=1
- φ2(x): 0 at x=0, increases to 1 at x=0.5, decreases back to 0 at x=1
- φ3(x): 0 until x=0.5, increases to 1 at x=1

The approximate solution is
u_h(x) = u1*φ1(x) + u2*φ2(x) + u3*φ3(x).

----------------------------------------------------
2. Problem Setup
----------------------------------------------------
We want to solve:
- u''(x) = -f(x),   with f(x)=1, μ=1
Domain: [0,1]
Boundary conditions: u(0)=u(1)=0

Mesh: 2 elements, nodes [0, 0.5, 1]

----------------------------------------------------
3. Local Matrices (Stiffness)
----------------------------------------------------
For each element [x_i, x_{i+1}] of length h, the local stiffness matrix is:

K^(e) = (μ/h) * [[ 1, -1],
                 [-1,  1]]

Here h = 0.5, so μ/h = 2.

Thus both elements have:
K^(1) = K^(2) = [[ 2, -2],
                 [-2,  2]]

----------------------------------------------------
4. Local RHS Vectors
----------------------------------------------------
The local right-hand side vector is:

F^(e)_i = ∫ f(x)*φ_i(x) dx over [x_i, x_{i+1}]

With f=1 and linear basis functions:
∫ φ_i(x) dx = h/2

So with h=0.5:
F^(1) = [0.25, 0.25]
F^(2) = [0.25, 0.25]

----------------------------------------------------
5. Assembly (Global System)
----------------------------------------------------
We map local nodes to global nodes:
- Element 1: [1,2] → global [1,2]
- Element 2: [1,2] → global [2,3]

Global matrix A (after adding contributions):
A = [[ 2, -2,  0],
     [-2,  4, -2],
     [ 0, -2,  2]]

Global vector F:
F = [0.25,
     0.50,
     0.25]

----------------------------------------------------
6. Apply Boundary Conditions
----------------------------------------------------
Since u(0)=0 and u(1)=0 → u1=0, u3=0.
Only unknown: u2.

Equation:
4*u2 = 0.5 → u2 = 0.125

----------------------------------------------------
7. Final Solution
----------------------------------------------------
Nodal values: (u1, u2, u3) = (0, 0.125, 0)
Approximation: piecewise linear "tent" function.

Exact solution: u(x) = 0.5*(x - x^2)
At x=0.5, exact u(0.5)=0.125, which matches FEM result.

----------------------------------------------------
Summary
----------------------------------------------------
- φ are shape functions (basis functions)
- Local element matrices/vectors are computed
- Assembly = adding them into a global system
- Boundary conditions reduce the system
- Solve the linear system → get approximate solution u_h(x)
